<!DOCTYPE html>
<html lang="ru">
<head>
    {% load static %}
    <meta charset="UTF-8" />
    <title>Главная страница</title>
    <link rel="stylesheet" href="{% static 'styling/base.css' %}" />
    <link rel="stylesheet" href="{% static 'styling/layout.css' %}" />
    <link rel="stylesheet" href="{% static 'styling/nav.css' %}" />
    <link rel="stylesheet" href="{% static 'styling/home.css' %}" />
</head>
<body class="home-body">
    <header>
        <h1 class="brand-title"><span style="color:#F28519;">Book</span>Blog Обмен</h1>
        {% if user.is_authenticated %}
          <p class="user-greeting">Привет, {{ user.username }}!</p>
          <nav>
            <form method="post" action="{% url 'logout' %}" style="display:inline;">
              {% csrf_token %}
              <button class="btn btn-logout" type="submit">Выйти</button>
            </form>
            <a href="{% url 'home' %}" class="btn-link">Главная</a>
            <a href="{% url 'profile' %}" class="btn-link">Профиль</a>
            <a href="{% url 'requests' %}" class="btn-link">Мои заявки</a>
            <a href="{% url 'available_requests' %}" class="btn-link">Доступные заявки</a>
            <a href="{% url 'request' %}" class="btn-link">Новая заявка</a>
          </nav>
        {% else %}
          <nav>
            <a href="{% url 'register' %}" class="btn-link">Регистрация</a>
            <a href="{% url 'login' %}" class="btn-link">Вход</a>
          </nav>
        {% endif %}
    </header>

<main class="home-main horizontal-flex">
    <div class="horizontal-flex">
        <section class="info-pane card-block">
        <h2 class="brand-title"><span style="color:#F28519;">Book</span>Blog Обмен</h2>
        <p class="main-description">
            Платформа для обмена блогами между авторами Литнет и ВКонтакте.<br>
            Находите новых читателей и увеличивайте охваты!
        </p>
        <ul class="quickstats">
            <li>
                <span>{{ stats.books|default:"32" }}</span><br>Объявлений
            </li>
            <li>
                <span>{{ stats.authors|default:"6" }}</span><br>Авторов
            </li>
            <li>
                <span>{{ stats.partners|default:"18" }}</span><br>Обменов
            </li>
        </ul>
        <div class="cta-row">
            <a class="btn-cta" href="{% url 'available_requests' %}">Смотреть заявки</a>
            <a class="btn-cta btn-secondary" href="{% url 'register' %}">Регистрация</a>
        </div>
    </section>

    <section class="calendar-pane card-block">
        <h3>Ваш календарь:</h3>
        <div class="calendar-header">
            <button id="prev-month" class="calendar-nav">&lt;</button>
            <span id="calendar-title"></span>
            <button id="next-month" class="calendar-nav">&gt;</button>
        </div>
        <div id="calendar"></div>
        <hr>
        <div class="calendar-legend">
            <strong>Обозначения:</strong>
            <ul class="legend-list">
                <li><span class="legend-color" style="background:#3adb62;"></span>Нужно сделать репост</li>
                <li><span class="legend-color" style="background:#2196F3;"></span>Ваша заявка подана</li>
                <li><span class="legend-color" style="background:#ffc0cb;"></span>Нет действий/свободно</li>
            </ul>
        </div>
    </section>
    </div>
</main>

<!-- Horizontal row for cards below -->
<div class="cards-row">
    <div class="feature-card">
        <h4>Авторы</h4>
        <p>Публичные профили и подбор по блогам</p>
        <a href="{% url 'profile' %}">К авторам</a>
    </div>
    <div class="feature-card">
        <h4>Заявки</h4>
        <p>Просматривайте и фильтруйте актуальные обмены</p>
        <a href="{% url 'available_requests' %}">К заявкам</a>
    </div>
    <div class="feature-card">
        <h4>Ваши обмены</h4>
        <p>Управляйте своими действующими заявками</p>
        <a href="{% url 'requests' %}">Мои заявки</a>
    </div>
</div>


    <script>
    var actionDates = {{ action_dates|safe }};
    var requestDates = {{ own_request_dates|safe }};
    var ownRequestMap = {{ own_request_map|safe }};
    </script>
    <script src="{% static 'scripts/calendar.js' %}"></script>
</body>
</html>
